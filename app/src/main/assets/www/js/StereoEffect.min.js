THREE.StereoEffect=function(e){this.separation=3,this.focalLength=15;var t,r,i,n,o,a,s,h,l,c,u,f,E=new THREE.Vector3,d=new THREE.Quaternion,p=new THREE.Vector3,m=new THREE.PerspectiveCamera,g=new THREE.PerspectiveCamera;e.autoClear=!1,this.setSize=function(i,n){t=i/2,r=n,e.setSize(i,n)},this.render=function(T,v){T.updateMatrixWorld(),void 0===v.parent&&v.updateMatrixWorld(),v.matrixWorld.decompose(E,d,p),i=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(v.fov)))),h=v.near/this.focalLength,c=Math.tan(.5*THREE.Math.degToRad(i))*this.focalLength,l=.5*c*v.aspect,a=c*h,s=-a,u=(l+this.separation/2)/(2*l),f=1-u,n=2*l*h*f,o=2*l*h*u,m.projectionMatrix.makeFrustum(-n,o,s,a,v.near,v.far),m.position.copy(E),m.quaternion.copy(d),m.translateX(-this.separation/2),g.projectionMatrix.makeFrustum(-o,n,s,a,v.near,v.far),g.position.copy(E),g.quaternion.copy(d),g.translateX(this.separation/2),e.setViewport(0,0,2*t,r),e.clear(),e.setViewport(0,0,t,r),e.render(T,m),e.setViewport(t,0,t,r),e.render(T,g)}};