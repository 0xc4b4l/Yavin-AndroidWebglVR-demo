!function(){function e(e){i=e}function t(){switch(window.screen.orientation||window.screen.mozOrientation){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0}return window.orientation||0}function r(){n=t()}var i={},n=window.orientation||0;window.addEventListener("deviceorientation",e,!1),window.addEventListener("orientationchange",r,!1),THREE.DeviceOrientationControls=function(e){this.object=e,this.object.rotation.reorder("YXZ"),this.freeze=!0,this.movementSpeed=1,this.rollSpeed=.005,this.autoAlign=!0,this.autoForward=!1,this.alpha=0,this.beta=0,this.gamma=0,this.orient=0,this.alignQuaternion=new THREE.Quaternion,this.orientationQuaternion=new THREE.Quaternion;var t=new THREE.Quaternion,r=new THREE.Quaternion,o=new THREE.Vector3,a=new THREE.Matrix4,s=new THREE.Euler(0,0,0,"YXZ"),h=new THREE.Quaternion,l=new THREE.Vector3(0,0,1),c=new THREE.Vector3(0,1,0),u=new THREE.Vector3(0,0,0),f=new THREE.Euler,E=new THREE.Quaternion,d=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));this.update=function(){return function(){this.freeze||(this.alpha=i.gamma?THREE.Math.degToRad(i.alpha):0,this.beta=i.beta?THREE.Math.degToRad(i.beta):0,this.gamma=i.gamma?THREE.Math.degToRad(i.gamma):0,this.orient=n?THREE.Math.degToRad(n):0,f.set(this.beta,this.alpha,-this.gamma,"YXZ"),t.setFromEuler(f),r.slerp(t,.5),this.orientationQuaternion.copy(this.autoAlign?t:r),this.orientationQuaternion.multiply(d),this.orientationQuaternion.multiply(E.setFromAxisAngle(l,-this.orient)),this.object.quaternion.copy(this.alignQuaternion),this.object.quaternion.multiply(this.orientationQuaternion),this.autoForward&&(o.set(0,0,-1).applyQuaternion(this.object.quaternion,"ZXY").setLength(this.movementSpeed/50),this.object.position.add(o)),this.autoAlign&&0!==this.alpha&&(this.autoAlign=!1,this.align()))}}(),this.align=function(){o.set(0,0,-1).applyQuaternion(h.copy(this.orientationQuaternion).inverse(),"ZXY"),s.setFromQuaternion(h.setFromRotationMatrix(a.lookAt(o,u,c))),s.set(0,s.y,0),this.alignQuaternion.setFromEuler(s)},this.connect=function(){this.freeze=!1},this.disconnect=function(){this.freze=!0}}}();